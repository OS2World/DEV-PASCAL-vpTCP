@ECHO OFF
ECHO Virtual Pascal Sockets Library Install
ECHO.
IF NOT EXIST VPTCP110 GOTO BADDIR
IF "%VPBASE%"=="" GOTO BADSETUP
IF NOT EXIST %VPBASE%BIN\VPC.EXE GOTO BADSETUP
ECHO REMOVING OLD FILES
IF EXIST %VPBASE%BIN\VPTCP.VPH DEL %VPBASE%BIN\VPTCP.VPH
IF EXIST %VPBASE%OUT\SOCKETS.* DEL %VPBASE%OUT\SOCKETS.*
IF EXIST %VPBASE%UNITS\SOCKETS.* DEL %VPBASE%UNITS\SOCKETS.*
IF EXIST %VPBASE%BIN\SOCKETS.VPH DEL %VPBASE%BIN\SOCKETS.VPH
ECHO.
ECHO COPYING FILES TO PROPER DESTINATIONS
COPY SOCKETS.VPH %VPBASE%BIN >NUL
COPY SOCKETS.LIB %VPBASE%UNITS >NUL
COPY SOCKETS.OBJ %VPBASE%UNITS >NUL
ECHO.
ECHO CREATING VP INTERFACE FILE
%VPBASE%BIN\VPC -Q -O%VPBASE%UNITS -U%VPBASE%UNITS SOCKETS.INT 1>NUL 2>NUL
ECHO.
ECHO DONE
GOTO END
:BADDIR
ECHO PLEASE RUN THIS PROGRAM FROM THE DIRECTORY THAT IT'S IN
GOTO END
:BADSETUP
ECHO YOU DON'T HAVE VIRTUAL PASCAL SETUP
:END
